{active:true,ruleGroups:{php_attacks:{active:true,action:deny,rules:{php_suffix:{has:1r[type,key,value|path,null,{suf:.php}],missing:1r[type,key,value|header,x-secret,{eq:bypass}],phase:finalize,system:true},jsp_suffix:{has:2x[{type:path,key:null,value:{suf:.jsp}},{type:status,value:{eq:404}}],missing:1r[type,key,value|header,x-secret,{eq:bypass}],phase:init,system:true},asp_suffix:{has:1r[type,key,value|path,null,{suf:.asp}],missing:1r[type,key,value|header,x-secret,{eq:bypass}],phase:finalize,system:true},cgi_suffix:{has:1r[type,key,value|path,null,{suf:.cgi}],missing:1r[type,key,value|header,x-secret,{eq:bypass}],phase:finalize,system:true}}},sql_injection:{active:true,action:deny,rules:{union_select:{has:1r[type,key,value|query,null,{contains:UNION SELECT}],phase:init,system:true},drop_table:{has:1r[type,key,value|query,null,{contains:DROP TABLE}],phase:init,system:true},or_1_equals_1:{has:1r[type,key,value|query,null,{regex:OR\s+1\s*=\s*1}],phase:init,system:true}}},rate_limiting:{active:true,action:ratelimit,rules:{api_endpoints:{has:1r[type,key,value|path,null,{pre:/api/}],rateLimit:{requests:100,window:60,key:ip},phase:init,system:false},auth_endpoints:{has:1r[type,key,value|path,null,{pre:/auth/}],rateLimit:{requests:10,window:60,key:ip},phase:init,system:false},search_endpoint:{has:1r[type,key,value|path,null,{eq:/search}],rateLimit:{requests:30,window:60,key:ip},phase:init,system:false}}},geo_blocking:{active:false,action:deny,rules:{blocked_countries:{has:1r[type,key,value|geo,country,{in:3x[XX,YY,ZZ]}],missing:1r[type,key,value|header,x-bypass-geo,{eq:allowed}],phase:init,system:false}}},bot_protection:{active:true,action:challenge,rules:{missing_ua:{missing:1r[type,key,value|header,user-agent,{exists:true}],phase:init,system:true},known_bad_bots:{has:1r[type,key,value|header,user-agent,{regex:"(BadBot|Scraper|Harvester)"}],phase:init,system:true},suspicious_rate:{has:2r[type,key,value|rate,ip,{gt:50}|header,user-agent,{regex:^Mozilla}],phase:finalize,system:false}}},custom_rules:{active:true,action:log,rules:{admin_access:{has:1r[type,key,value|path,null,{pre:/admin}],missing:1r[type,key,value|header,x-admin-token,{exists:true}],phase:init,system:false},api_key_required:{has:1r[type,key,value|path,null,{pre:/api/v2/}],missing:1r[type,key,value|header,x-api-key,{exists:true}],phase:init,system:false}}}}}